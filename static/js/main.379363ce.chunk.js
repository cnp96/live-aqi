/*! For license information please see main.379363ce.chunk.js.LICENSE.txt */
(this["webpackJsonplive-aqi"]=this["webpackJsonplive-aqi"]||[]).push([[0],{17:function(e,t,n){},21:function(e,t,n){},24:function(e,t,n){"use strict";n.r(t);var c=n(1),a=n.n(c),r=n(6),i=n.n(r),o=(n(17),n(2)),s=n(7),l=n(10),d=n(11),j=n(8),u=function(e,t){switch(t.type){case"update":var n,c=new Date,a=t.payload,r=Object(j.a)(a);try{for(r.s();!(n=r.n()).done;){var i=n.value;e[i.city]={aqi:i.aqi,lastUpdated:c}}}catch(o){r.e(o)}finally{r.f()}return Object(d.a)({},e);default:return e}},b=function(e,t){switch(t.type){case"add":var n=[].concat(Object(l.a)(e),[{x:new Date,y:parseFloat(t.payload.toFixed(2))}]);return n.length>20&&n.shift(),n;case"clear":return[];default:return e}},h=(n(21),n(9)),O=function(e){var t=((new Date).valueOf()-e.valueOf())/1e3,n=t/60;return t<=1?"now":t<60?"".concat(0^t," second(s) ago"):n<60?"".concat(0^n," minute(s) ago"):"at ".concat(e.toISOString())},f=n(0),x=c.memo((function(e){var t=c.useState(),n=Object(o.a)(t,2),a=n[0],r=n[1],i=e.data,s=Object.entries(i);return Object(f.jsxs)("table",{className:"styled-table",children:[Object(f.jsx)("thead",{children:Object(f.jsxs)("tr",{children:[Object(f.jsx)("th",{children:"Index"}),Object(f.jsx)("th",{children:"City"}),Object(f.jsx)("th",{children:"Current AQI"}),Object(f.jsx)("th",{children:"Last Updated"}),Object(f.jsx)("th",{children:"Action"})]})}),Object(f.jsx)("tbody",{children:s.length?s.map((function(t,n){var c,i=Object(o.a)(t,2),s=i[0],l=i[1],d=(c=l.aqi)<=50?"good":c<=100?"satisfactory":c<=200?"moderate":c<=300?"poor":c<=400?"very-poor":"severe";return Object(f.jsxs)("tr",{className:s===a?"active":"",children:[Object(f.jsx)("td",{children:n}),Object(f.jsx)("td",{children:Object(h.capitalize)(s)}),Object(f.jsx)("td",{className:"aqi ".concat(d),children:l.aqi.toFixed(2)}),Object(f.jsx)("td",{children:O(l.lastUpdated)}),Object(f.jsx)("td",{children:Object(f.jsx)("button",{onClick:function(){return function(t){var n=a===t?void 0:t;r(n),e.onChange&&e.onChange(n)}(s)},children:a===s?"Clear selection":"Live Chart"})})]},n)})):Object(f.jsx)("tr",{children:Object(f.jsx)("td",{colSpan:5,children:Object(f.jsx)("div",{className:"w-100 d-flex justify-center",children:"Please wait..."})})})})]})})),v=a.a.lazy((function(){return Promise.all([n.e(3),n.e(4)]).then(n.bind(null,27))}));function p(){var e,t=Object(c.useReducer)(u,{}),n=Object(o.a)(t,2),r=n[0],i=n[1],l=Object(c.useState)(),d=Object(o.a)(l,2),j=d[0],h=d[1],O=Object(c.useRef)(),p=Object(c.useReducer)(b,[]),y=Object(o.a)(p,2),g=y[0],m=y[1],w=function(e){i({type:"update",payload:e});var t=e.find((function(e){return e.city===O.current}));t&&m({type:"add",payload:t.aqi})},C=function t(n){return(e=new s.w3cwebsocket("wss://city-ws.herokuapp.com")).onopen=function(){console.log("WebSocket Client Connected")},e.onmessage=function(e){var t=JSON.parse(e.data);n&&n(t)},e.onerror=function(t){e.close(3001),console.error(t)},e.onclose=function(c){if(c.code<3e3)var a=setInterval((function(){3===e.readyState?(console.log("Reconnecting to server"),e=t(n)):clearInterval(a)}),500)},e};return Object(c.useEffect)((function(){return e=C(w),function(){e.close(3e3),console.log("Client disconnected")}}),[]),Object(f.jsx)("main",{children:Object(f.jsxs)("div",{className:"overview",children:[Object(f.jsx)(x,{data:r,onChange:function(e){h(e),O.current=e,m({type:"clear"})}}),j?Object(f.jsx)("div",{className:"chart",children:Object(f.jsxs)(a.a.Suspense,{fallback:"Loading chart...",children:[Object(f.jsx)(v,{label:j,data:g}),Object(f.jsx)("p",{children:"Showing a maximum of 20 records"})]})}):null]})})}var y=function(e){e&&e instanceof Function&&n.e(5).then(n.bind(null,28)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),c(e),a(e),r(e),i(e)}))};i.a.render(Object(f.jsx)(a.a.StrictMode,{children:Object(f.jsx)(p,{})}),document.getElementById("root")),y()}},[[24,1,2]]]);
//# sourceMappingURL=main.379363ce.chunk.js.map